{"version":3,"sources":["Components/DevAdmin/Products/CreateProduct.jsx"],"names":["CreateProduct","history","useHistory","useStateValue","categoriesAPI","productsAPI","userAPI","isAdmin","categories","callback","setCallback","useState","imageUpload","setImageUpload","imageShow","setImageShow","loading","setLoading","product_id","title","description","price","category","images","data","setData","handleFileChange","e","a","getFile","target","files","alert","formData","FormData","append","reader","FileReader","onloadend","result","readAsDataURL","handleChange","name","value","prevValues","uploadImage","axios","post","headers","res","console","log","response","productFunc","d","public_id","url","error","handleSubmit","preventDefault","then","push","className","style","margin","onSubmit","required","type","onChange","src","alt","width","height","objectFit","onClick","placeholder","defaultValue","disabled","map","i","color","letterSpacing"],"mappings":"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","file":"static/js/6.15ac9c30.chunk.js","sourcesContent":["import React, { useState } from \"react\";\nimport axios from \"axios\";\nimport { useStateValue } from \"../../../StateProvider\";\nimport \"./CreateProduct.css\";\nimport Loading from \"../../Screens/Global/Loading\";\n\nimport { useHistory } from \"react-router\";\n\nconst CreateProduct = () => {\n  const history = useHistory();\n  const { categoriesAPI, productsAPI, userAPI } = useStateValue();\n  const [isAdmin] = userAPI.isAdmin;\n  const [categories] = categoriesAPI.categories;\n  const [callback, setCallback] = productsAPI.callback;\n\n  const [imageUpload, setImageUpload] = useState(false);\n  const [imageShow, setImageShow] = useState();\n  const [loading, setLoading] = useState(false);\n\n  const [data, setData] = useState({\n    product_id: \"\",\n    title: \"\",\n    description: \"\",\n    price: \"\",\n    category: \"\",\n    images: \"\",\n  });\n\n  const handleFileChange = async (e) => {\n    const getFile = e.target.files[0];\n    if (!getFile) return alert(\"File Doesn't exist\");\n\n    let formData = new FormData();\n    formData.append(\"file\", getFile);\n    setImageUpload(formData);\n    const reader = new FileReader();\n\n    reader.onloadend = () => {\n      setImageShow(reader.result);\n    };\n\n    reader.readAsDataURL(getFile);\n  };\n\n  const handleChange = (e) => {\n    const { name, value } = e.target;\n\n    setData((prevValues) => ({\n      ...prevValues,\n      [name]: value,\n    }));\n  };\n\n  const cancelImage = () => {\n    setImageShow(null);\n    setImageUpload(false);\n  };\n\n  const uploadImage = async () => {\n    try {\n      const res = await axios.post(\"/api/upload\", imageUpload, {\n        headers: {\n          \"Content-Type\": \"multipart/form-data\",\n        },\n      });\n\n      return res;\n    } catch (error) {\n      console.log(\"createProduct uploadimage: error: \", error.response);\n    }\n  };\n\n  const productFunc = async (d) => {\n    try {\n      const res = await axios.post(\"/api/products\", {\n        ...data,\n        images: { public_id: d.data.public_id, url: d.data.url },\n      });\n\n      return res;\n    } catch (error) {\n      alert(error.response.data.error);\n    }\n  };\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    setLoading(true);\n    uploadImage()\n      .then(productFunc)\n      .then(() => {\n        setCallback(!callback);\n        setLoading(false);\n        history.push(\"/dashboard/products\");\n      });\n    // try {\n    // } catch (err) {\n    //   console.log(\"err: \", err);\n    // }\n  };\n\n  if (!isAdmin) {\n    return (\n      <h1 style={{ margin: \"15px\", color: \"red\", letterSpacing: \"2px\" }}>\n        You don't have permission to visit this route\n      </h1>\n    );\n  }\n\n  if (loading) {\n    return <Loading />;\n  }\n\n  return (\n    <div className=\"create__product\">\n      <h1 style={{ margin: \"0 30px \" }}>Create Product</h1>\n\n      {/* <div className=\"create__product-container\"> */}\n      <form onSubmit={handleSubmit} className=\"create__product-form\">\n        <div className=\"create__product-container-leftSection\">\n          {!imageShow && (\n            <input\n              required\n              type=\"file\"\n              name=\"file\"\n              onChange={handleFileChange}\n              className=\"create__product-leftSection-image-input\"\n            />\n          )}\n          {imageShow && (\n            <div className=\"create__product-image-preview\">\n              <img\n                required\n                src={imageShow}\n                alt=\"\"\n                width=\"100%\"\n                height=\"100%\"\n                style={{ objectFit: \"cover\" }}\n              />\n\n              <div\n                className=\"create__product-cancel-image\"\n                onClick={cancelImage}>\n                X\n              </div>\n            </div>\n          )}\n        </div>\n\n        <div className=\"create__product-container-rightSection\">\n          <div className=\"create__product-input\">\n            <input\n              required\n              type=\"text\"\n              placeholder=\"Product Id\"\n              value={data.product_id}\n              onChange={handleChange}\n              name=\"product_id\"\n            />\n          </div>\n\n          <div className=\"create__product-input\">\n            <input\n              required\n              type=\"text\"\n              name=\"title\"\n              placeholder=\"Title\"\n              value={data.title}\n              onChange={handleChange}\n            />\n          </div>\n\n          <div className=\"create__product-input\">\n            <input\n              required\n              type=\"text\"\n              placeholder=\"Description\"\n              value={data.description}\n              onChange={handleChange}\n              name=\"description\"\n            />\n          </div>\n\n          <div className=\"create__product-input\">\n            <input\n              required\n              type=\"text\"\n              placeholder=\"Price\"\n              value={data.price}\n              onChange={handleChange}\n              name=\"price\"\n            />\n          </div>\n          <div className=\"create__product-input\">\n            <select\n              name=\"category\"\n              onChange={handleChange}\n              defaultValue=\"Category\"\n              required>\n              <option value=\"Category\" disabled>\n                Select Category\n              </option>\n              {categories.map((category, i) => (\n                <option key={i} value={category.name}>\n                  {category.name}\n                </option>\n              ))}\n            </select>\n          </div>\n          <button className=\"create__product-form-button\">Submit</button>\n        </div>\n      </form>\n      {/* </div> */}\n    </div>\n  );\n};\n\nexport default CreateProduct;\n"],"sourceRoot":""}