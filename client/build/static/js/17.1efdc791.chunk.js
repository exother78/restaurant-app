(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[17],{210:function(e,t,a){},315:function(e,t,a){"use strict";a.r(t);var r=a(22),n=a(25),c=a(6),s=a.n(c),u=a(10),i=a(4),o=a(12),l=a.n(o),p=a(1),b=(a(210),a(19)),d=a(3),j=a(0),f=Object(p.lazy)((function(){return a.e(18).then(a.bind(null,235))}));t.default=function(){var e=Object(b.b)(),t=e.categoriesAPI,a=e.userAPI,c=e.token,o=Object(i.a)(t.categories,1)[0],h=Object(i.a)(t.callback,2),m=h[0],O=h[1],x=Object(i.a)(a.isAdmin,1)[0],g=Object(p.useState)({name:"",images:""}),v=Object(i.a)(g,2),y=v[0],_=v[1],k=Object(p.useState)(null),w=Object(i.a)(k,2),S=w[0],A=w[1],N=Object(p.useState)(null),z=Object(i.a)(N,2),B=z[0],C=z[1],D=Object(p.useState)(!1),F=Object(i.a)(D,2),I=F[0],U=F[1],J=Object(p.useState)(!1),P=Object(i.a)(J,2),R=P[0],T=P[1],q=Object(p.useState)(!1),E=Object(i.a)(q,2),L=E[0],G=E[1],H=Object(p.useState)(""),K=Object(i.a)(H,2),M=K[0],Q=K[1],V=Object(p.useState)(null),W=Object(i.a)(V,2),X=W[0],Y=W[1],Z=Object(p.useState)(null),$=Object(i.a)(Z,2),ee=$[0],te=$[1],ae=function(){var e=Object(u.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!x){e.next=6;break}return e.next=4,l.a.post("/api/upload",B,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer ".concat(c[0])}});case 4:return t=e.sent,e.abrupt("return",t);case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0.response.data.error);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),re=function(){var e=Object(u.a)(s.a.mark((function e(t){var a,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!t){e.next=6;break}return e.next=4,l.a.post("/api/category",Object(n.a)(Object(n.a)({},y),{},{images:{public_id:t.data.public_id,url:t.data.url}}),{headers:{Authorization:"Bearer ".concat(c[0])}});case 4:return a=e.sent,e.abrupt("return",a);case 6:if(t){e.next=11;break}return e.next=9,l.a.post("/api/category",Object(n.a)({},y),{headers:{Authorization:"Bearer ".concat(c[0])}});case 9:return r=e.sent,e.abrupt("return",r);case 11:e.next=17;break;case 13:return e.prev=13,e.t0=e.catch(0),Y(e.t0.response.data.error),e.abrupt("return");case 17:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(t){return e.apply(this,arguments)}}(),ne=function(){var e=Object(u.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),T(!0);try{S&&ae().then(re).then((function(e){O(!m),T(!1),_({name:"",images:""}),A(null),C(null),te(e.data.message)})),S||re().then((function(e){O(!m),T(!1),_({name:"",images:""}),A(null),C(null),te(e.data.message)}))}catch(a){Y(a.response.data.error)}case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();(ee||X)&&setTimeout((function(){te(null),Y(null)}),2e3);var ce=function(){var e=Object(u.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!t){e.next=4;break}return e.next=4,l.a.post("/api/destroy",{public_id:t},{headers:{Authorization:"Bearer ".concat(c[0])}});case 4:if(t){e.next=7;break}return e.next=7,l.a.post("/api/destroy",{public_id:y.images.public_id},{headers:{Authorization:"Bearer ".concat(c[0])}});case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log("delete category image error: ",e.t0.response.data);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),se=function(){G(!1),T(!1),O(!m),A(null),C(null),_({images:"",name:""})},ue=function(){var e=Object(u.a)(s.a.mark((function e(t){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),T(!0),a=function(){var e=Object(u.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!t){e.next=6;break}return e.next=4,l.a.patch("/api/category/".concat(M),{name:y.name,images:{public_id:t.data.public_id,url:t.data.url}},{headers:{Authorization:"Bearer ".concat(c[0])}});case 4:case 9:return se(),e.abrupt("return");case 6:if(t){e.next=11;break}return e.next=9,l.a.patch("/api/category/".concat(M),{name:y.name,images:y.images},{headers:{Authorization:"Bearer ".concat(c[0])}});case 11:e.next=17;break;case 13:return e.prev=13,e.t0=e.catch(0),console.log("categoryUpdate error: "),e.abrupt("return");case 17:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(t){return e.apply(this,arguments)}}(),B&&ce().then(ae).then(a),B||a();case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ie=function(){var e=Object(u.a)(s.a.mark((function e(t){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:U(!0),a=function(){var e=Object(u.a)(s.a.mark((function e(){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.a.delete("/api/category/".concat(t._id),{headers:{Authorization:"Bearer ".concat(c[0])}});case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ce(t.images.public_id).then(a).then((function(e){O(!m),U(!1),te(e.data.message)}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return o?Object(j.jsxs)("div",{className:"categories__screen",children:[X&&Object(j.jsx)("div",{className:"error__box",children:X}),ee&&Object(j.jsx)("div",{className:"success__box",children:ee}),R?Object(j.jsx)(d.a,{}):Object(j.jsx)("div",{className:"create__category",children:Object(j.jsxs)("form",{onSubmit:L?ue:ne,children:[Object(j.jsxs)("div",{className:"category__img",children:[Object(j.jsx)("h3",{style:{letterSpacing:"1.3px",padding:"10px 20px",userSelect:"none"},children:"Add a Category"}),!S&&Object(j.jsx)("input",{type:"file",className:"category__img-input",onChange:function(e){var t=e.target.files[0];if(!t)return alert("File Doesn't exist");var a=new FormData;a.append("file",t),C(a);var r=new FileReader;r.readAsDataURL(t),r.onloadend=function(){A(r.result)}}}),S&&Object(j.jsx)("img",{style:{userSelect:"none"},src:S,alt:""}),S&&Object(j.jsx)("span",{className:"category__form-clear-img",onClick:function(){C(null),A(null)},children:"Clear Image"})]}),Object(j.jsx)("div",{className:"category__input-group",children:Object(j.jsx)("input",{type:"text",name:"name",placeholder:"Name *",required:!0,className:"category__input create__category-input-here",value:y.name,onChange:function(e){var t=e.target,a=t.name,c=t.value;_((function(e){return Object(n.a)(Object(n.a)({},e),{},Object(r.a)({},a,c))}))}})}),L?Object(j.jsx)("button",{className:"category__submit-button",type:"submit",children:"Update"}):Object(j.jsx)("button",{className:"category__submit-button",type:"submit",children:"Submit"})]})}),I?Object(j.jsx)(d.a,{}):Object(j.jsx)(p.Suspense,{fallback:Object(j.jsx)(d.a,{}),children:Object(j.jsx)(f,{categories:o,handleDelete:ie,handleEdit:function(e){G(!0),_(Object(n.a)(Object(n.a)({},y),{},{images:e.images,name:e.name})),A(e.images.url),Q(e._id)}})})]}):Object(j.jsx)(d.a,{})}}}]);
//# sourceMappingURL=17.1efdc791.chunk.js.map