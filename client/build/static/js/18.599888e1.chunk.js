(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[18],{221:function(e,t,a){},326:function(e,t,a){"use strict";a.r(t);var r=a(12),n=a(99),c=a(7),s=a.n(c),u=a(8),i=a(2),o=a(10),l=a.n(o),p=a(1),b=(a(221),a(13)),j=a(5),f=a(0),d=Object(p.lazy)((function(){return a.e(24).then(a.bind(null,242))}));t.default=function(){var e=Object(b.b)(),t=e.categoriesAPI,a=e.userAPI,c=e.token,o=Object(i.a)(t.categories,1)[0],O=Object(i.a)(t.callback,2),h=O[0],m=O[1],g=Object(i.a)(a.isAdmin,1)[0],x=Object(p.useState)({name:"",images:""}),v=Object(i.a)(x,2),y=v[0],_=v[1],k=Object(p.useState)(null),w=Object(i.a)(k,2),S=w[0],A=w[1],N=Object(p.useState)(null),D=Object(i.a)(N,2),P=D[0],z=D[1],B=Object(p.useState)(!1),C=Object(i.a)(B,2),E=C[0],F=C[1],I=Object(p.useState)(!1),U=Object(i.a)(I,2),J=U[0],R=U[1],T=Object(p.useState)(!1),q=Object(i.a)(T,2),L=q[0],G=q[1],H=Object(p.useState)(""),K=Object(i.a)(H,2),M=K[0],Q=K[1],V=Object(p.useState)(null),W=Object(i.a)(V,2),X=W[0],Y=W[1],Z=Object(p.useState)(null),$=Object(i.a)(Z,2),ee=$[0],te=$[1],ae=function(){var e=Object(u.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!g){e.next=6;break}return e.next=4,l.a.post("/api/upload",P,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer ".concat(c[0])}});case 4:return t=e.sent,e.abrupt("return",t);case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0.response.data.error);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),re=function(){var e=Object(u.a)(s.a.mark((function e(t){var a,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!t){e.next=6;break}return e.next=4,l.a.post("/api/category",Object(n.a)(Object(n.a)({},y),{},{images:{public_id:t.data.public_id,url:t.data.url}}),{headers:{Authorization:"Bearer ".concat(c[0])}});case 4:return a=e.sent,e.abrupt("return",a);case 6:if(t){e.next=11;break}return e.next=9,l.a.post("/api/category",Object(n.a)({},y),{headers:{Authorization:"Bearer ".concat(c[0])}});case 9:return r=e.sent,e.abrupt("return",r);case 11:e.next=17;break;case 13:return e.prev=13,e.t0=e.catch(0),Y(e.t0.response.data.error),e.abrupt("return");case 17:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(t){return e.apply(this,arguments)}}(),ne=function(){var e=Object(u.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),R(!0);try{S&&ae().then(re).then((function(e){m(!h),R(!1),_({name:"",images:""}),A(null),z(null),te(e.data.message)})),S||re().then((function(e){m(!h),R(!1),_({name:"",images:""}),A(null),z(null),te(e.data.message)}))}catch(a){Y(a.response.data.error)}case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();(ee||X)&&setTimeout((function(){te(null),Y(null)}),2e3);var ce=function(){var e=Object(u.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!t){e.next=4;break}return e.next=4,l.a.post("/api/destroy",{public_id:t},{headers:{Authorization:"Bearer ".concat(c[0])}});case 4:if(t){e.next=7;break}return e.next=7,l.a.post("/api/destroy",{public_id:y.images.public_id},{headers:{Authorization:"Bearer ".concat(c[0])}});case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log("delete category image error: ",e.t0.response.data);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),se=function(){G(!1),R(!1),m(!h),A(null),z(null),_({images:"",name:""})},ue=function(){var e=Object(u.a)(s.a.mark((function e(t){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),R(!0),a=function(){var e=Object(u.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!t){e.next=6;break}return e.next=4,l.a.patch("/api/category/".concat(M),{name:y.name,images:{public_id:t.data.public_id,url:t.data.url}},{headers:{Authorization:"Bearer ".concat(c[0])}});case 4:case 9:return se(),e.abrupt("return");case 6:if(t){e.next=11;break}return e.next=9,l.a.patch("/api/category/".concat(M),{name:y.name,images:y.images},{headers:{Authorization:"Bearer ".concat(c[0])}});case 11:e.next=17;break;case 13:return e.prev=13,e.t0=e.catch(0),console.log("categoryUpdate error: "),e.abrupt("return");case 17:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(t){return e.apply(this,arguments)}}(),P&&ce().then(ae).then(a),P||a();case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ie=function(){var e=Object(u.a)(s.a.mark((function e(t){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:F(!0),a=function(){var e=Object(u.a)(s.a.mark((function e(){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.a.delete("/api/category/".concat(t._id),{headers:{Authorization:"Bearer ".concat(c[0])}});case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ce(t.images.public_id).then(a).then((function(e){m(!h),F(!1),te(e.data.message)}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return o?Object(f.jsxs)("div",{className:"categories__screen",children:[X&&Object(f.jsx)("div",{className:"error__box",children:X}),ee&&Object(f.jsx)("div",{className:"success__box",children:ee}),J?Object(f.jsx)(j.a,{}):Object(f.jsx)("div",{className:"create__category",children:Object(f.jsxs)("form",{onSubmit:L?ue:ne,children:[Object(f.jsxs)("div",{className:"category__img",children:[Object(f.jsx)("h3",{style:{letterSpacing:"1.3px",padding:"10px 20px",userSelect:"none"},children:"Add a Category"}),!S&&Object(f.jsx)("input",{type:"file",className:"category__img-input",onChange:function(e){var t=e.target.files[0];if(!t)return alert("File Doesn't exist");var a=new FormData;a.append("file",t),z(a);var r=new FileReader;r.readAsDataURL(t),r.onloadend=function(){A(r.result)}}}),S&&Object(f.jsx)("img",{style:{userSelect:"none"},src:S,alt:""}),S&&Object(f.jsx)("span",{className:"category__form-clear-img",onClick:function(){z(null),A(null)},children:"Clear Image"})]}),Object(f.jsx)("div",{className:"category__input-group",children:Object(f.jsx)("input",{type:"text",name:"name",placeholder:"Name *",required:!0,className:"category__input create__category-input-here",value:y.name,onChange:function(e){var t=e.target,a=t.name,c=t.value;_((function(e){return Object(n.a)(Object(n.a)({},e),{},Object(r.a)({},a,c))}))}})}),L?Object(f.jsx)("button",{className:"category__submit-button",type:"submit",children:"Update"}):Object(f.jsx)("button",{className:"category__submit-button",type:"submit",children:"Submit"})]})}),E?Object(f.jsx)(j.a,{}):Object(f.jsx)(p.Suspense,{fallback:Object(f.jsx)(j.a,{}),children:Object(f.jsx)(d,{categories:o,handleDelete:ie,handleEdit:function(e){G(!0),_(Object(n.a)(Object(n.a)({},y),{},{images:e.images,name:e.name})),A(e.images.url),Q(e._id)}})})]}):Object(f.jsx)(j.a,{})}},99:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var r=a(12);function n(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function c(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?n(Object(a),!0).forEach((function(t){Object(r.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):n(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}}}]);
//# sourceMappingURL=18.599888e1.chunk.js.map