{"version":3,"sources":["Components/DevAdmin/Products/CreateProduct.jsx"],"names":["CreateProduct","history","useHistory","useStateValue","categoriesAPI","productsAPI","userAPI","token","isAdmin","categories","callback","setCallback","useState","imageUpload","setImageUpload","imageShow","setImageShow","loading","setLoading","error","setError","product_id","title","description","price","category","images","data","setData","handleFileChange","e","a","getFile","target","files","alert","formData","FormData","append","reader","FileReader","onloadend","result","readAsDataURL","handleChange","name","value","prevValues","uploadImage","axios","post","headers","res","response","funcWithImg","d","public_id","url","Authorization","push","funcWithoutImg","productFunc","handleSubmit","preventDefault","then","setTimeout","className","style","margin","onSubmit","type","onChange","src","alt","width","height","objectFit","onClick","required","placeholder","defaultValue","disabled","map","i","color","letterSpacing"],"mappings":"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","file":"static/js/29.45ce6ff6.chunk.js","sourcesContent":["import React, { useState } from \"react\";\nimport axios from \"axios\";\nimport { useStateValue } from \"../../../StateProvider\";\nimport Loading from \"../../Screens/Global/Loading\";\n\nimport { useHistory } from \"react-router\";\n\nconst CreateProduct = () => {\n  const history = useHistory();\n  const { categoriesAPI, productsAPI, userAPI, token } = useStateValue();\n  const [isAdmin] = userAPI.isAdmin;\n  const [categories] = categoriesAPI.categories;\n  const [callback, setCallback] = productsAPI.callback;\n\n  const [imageUpload, setImageUpload] = useState(false);\n  const [imageShow, setImageShow] = useState();\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(null);\n\n  const [data, setData] = useState({\n    product_id: \"\",\n    title: \"\",\n    description: \"\",\n    price: \"\",\n    category: \"\",\n    images: \"\",\n  });\n\n  const handleFileChange = async (e) => {\n    const getFile = e.target.files[0];\n    if (!getFile) return alert(\"File Doesn't exist\");\n\n    let formData = new FormData();\n    formData.append(\"file\", getFile);\n    setImageUpload(formData);\n    const reader = new FileReader();\n\n    reader.onloadend = () => {\n      setImageShow(reader.result);\n    };\n\n    reader.readAsDataURL(getFile);\n  };\n\n  const handleChange = (e) => {\n    const { name, value } = e.target;\n\n    setData((prevValues) => ({\n      ...prevValues,\n      [name]: value,\n    }));\n  };\n\n  const cancelImage = () => {\n    setImageShow(null);\n    setImageUpload(false);\n  };\n\n  const uploadImage = async () => {\n    try {\n      const res = await axios.post(\"/api/upload\", imageUpload, {\n        headers: {\n          \"Content-Type\": \"multipart/form-data\",\n        },\n      });\n\n      return res;\n    } catch (error) {\n      setError(error.response.data.error);\n    }\n  };\n\n  const funcWithImg = async (d) => {\n    try {\n      const res = await axios.post(\n        \"/api/products\",\n        {\n          ...data,\n          images: { public_id: d.data.public_id, url: d.data.url },\n        },\n        {\n          headers: {\n            Authorization: `Bearer ${token[0]}`,\n          },\n        }\n      );\n      setCallback(!callback);\n      setLoading(false);\n      history.push(\"/dashboard/products\");\n\n      return res;\n    } catch (error) {\n      setError(error.response.data.error);\n      setLoading(false);\n      return error.response.data;\n    }\n  };\n\n  const funcWithoutImg = async () => {\n    try {\n      const res = await axios.post(\n        \"/api/products\",\n        {\n          ...data,\n        },\n        {\n          headers: {\n            Authorization: `Bearer ${token[0]}`,\n          },\n        }\n      );\n      setCallback(!callback);\n      setLoading(false);\n      history.push(\"/dashboard/products\");\n\n      return res;\n    } catch (error) {\n      setError(error.response.data.error);\n      setLoading(false);\n      return error.response.data;\n    }\n  };\n\n  const productFunc = async (d) => {\n    if (d) {\n      funcWithImg(d);\n    }\n    if (!d) {\n      funcWithoutImg();\n    }\n  };\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    if (imageUpload) {\n      setLoading(true);\n      uploadImage().then(productFunc);\n    }\n    if (!imageUpload) {\n      productFunc();\n    }\n  };\n\n  if (!isAdmin) {\n    return (\n      <h1 style={{ margin: \"15px\", color: \"red\", letterSpacing: \"2px\" }}>\n        You don't have permission to visit this route\n      </h1>\n    );\n  }\n\n  if (error) {\n    setTimeout(() => {\n      setError(null);\n    }, 2000);\n  }\n\n  if (loading) {\n    return <Loading />;\n  }\n\n  return (\n    <div className=\"create__product\">\n      {error && <div className=\"error__box\">{error}</div>}\n      <h1 style={{ margin: \"0 30px \" }}>Create Product</h1>\n\n      <form onSubmit={handleSubmit} className=\"create__product-form\">\n        <div className=\"create__product-container-leftSection\">\n          {!imageShow && (\n            <input\n              type=\"file\"\n              name=\"file\"\n              onChange={handleFileChange}\n              className=\"create__product-leftSection-image-input\"\n            />\n          )}\n          {imageShow && (\n            <div className=\"create__product-image-preview\">\n              <img\n                src={imageShow}\n                alt=\"\"\n                width=\"100%\"\n                height=\"100%\"\n                style={{ objectFit: \"cover\" }}\n              />\n\n              <div\n                className=\"create__product-cancel-image\"\n                onClick={cancelImage}>\n                X\n              </div>\n            </div>\n          )}\n        </div>\n\n        <div className=\"create__product-container-rightSection\">\n          <div className=\"create__product-input\">\n            <input\n              required\n              type=\"text\"\n              placeholder=\"Product Id\"\n              value={data.product_id}\n              onChange={handleChange}\n              name=\"product_id\"\n            />\n          </div>\n\n          <div className=\"create__product-input\">\n            <input\n              required\n              type=\"text\"\n              name=\"title\"\n              placeholder=\"Title\"\n              value={data.title}\n              onChange={handleChange}\n            />\n          </div>\n\n          <div className=\"create__product-input\">\n            <input\n              type=\"text\"\n              placeholder=\"Description\"\n              value={data.description}\n              onChange={handleChange}\n              name=\"description\"\n            />\n          </div>\n\n          <div className=\"create__product-input\">\n            <input\n              required\n              type=\"text\"\n              placeholder=\"Price\"\n              value={data.price}\n              onChange={handleChange}\n              name=\"price\"\n            />\n          </div>\n          <div className=\"create__product-input\">\n            <select\n              name=\"category\"\n              onChange={handleChange}\n              defaultValue=\"Category\"\n              required>\n              <option value=\"Category\" disabled>\n                Select Category\n              </option>\n              {categories.map((category, i) => (\n                <option key={i} value={category.name}>\n                  {category.name}\n                </option>\n              ))}\n            </select>\n          </div>\n          <button className=\"create__product-form-button\">Submit</button>\n        </div>\n      </form>\n    </div>\n  );\n};\n\nexport default CreateProduct;\n"],"sourceRoot":""}